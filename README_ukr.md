# Kefir

[English](README.md)

## Що таке Kefir

Це збірка, що складається з модифікованого Atmosphere, необхідних програм та скриптів, які все правильно встановлюють. Вона створена для полегшення встановлення та обслуговування програмного забезпечення на зламаній Nintendo Switch. Зміни, внесені в Atmosphere, спрямовані на покращення якості використання самої системи.

Головні відмінності від ванільного Atmosphere:
  * Версії Kefir поряд із версіями системи
  * Встановлення драйвера exFAT карти пам'яті за замовчуванням при оновленні системи
  * Видалення перевірки ACID підпису для використання homebrew без патчів
  * Видалення системного логування для запобігання засміченню карти пам'яті та надмірному використанню
  * Перенаправлення збережень з внутрішньої пам'яті на карту пам'яті при використанні emuNAND для зменшення ймовірності їх втрати у разі відмови emuNAND (опціонально)

**Kefir** — це **не прошивка**! Це збірка, що складається з прошивки Atmosphere та необхідного мінімуму рекомендованих програм, плагінів, модулів та іншого програмного забезпечення.

## Навіщо потрібен Kefir?

Перш за все, Kefir потрібен для спрощення життя користувача. Тобто, якщо у користувача є рекомендована версія системного програмного забезпечення та остання версія Kefir, то все повинно працювати для нього. Можна сказати, що користувач знаходиться в контрольованих умовах. Достатньо назвати версію системного програмного забезпечення та Kefir, і відразу стає зрозуміло, що приблизно встановлено в системі.

## Склад Kefir

1. **[Kefirosphere](https://github.com/rashevskyv/Kefirosphere)**, форк [Atmosphere](https://github.com/Atmosphere-NX/Atmosphere)
2. **Патчі підписів**. Завдяки їм, ви можете запускати непідписані (читай: *піратські*) програми та ігри на Atmosphere.
3. **Завантажувач [hekate](https://github.com/CTCaer/hekate)**: Завдяки завантажувачу, ви можете запускати прошивку та інші пейлоади через зручне меню, створювати та відновлювати резервні копії NAND, робити EmuNAND, отримувати інформацію про стан системи, монтувати карту пам'яті до ПК без її видалення зі свіча, перерозподіляти карту пам'яті для встановлення інших ОС та багато іншого
4. **Встановлені пейлоади**:
  * [Lockpick_RCM](https://codeberg.org/rashevskyv/Locktrick/) - програма для дампу ключів консолі
  * [TegraExplorer](https://github.com/rashevskyv/TegraExplorer/) - файловий менеджер для Switch у вигляді пейлоаду. Аналог GodMode9 для 3DS
5. **Встановлені Homebrew**
  * [DBI](https://github.com/rashevskyv/dbi) - програма для встановлення ігор через USB або з карти пам'яті
  * [Tinfoil](http://tinfoil.io) - програма, що дозволяє завантажувати ігри для консолі безпосередньо з мережі
  * [Kefir Updater](https://github.com/rashevskyv/kefir-updater) - програма для оновлення kefir через інтернет
  * [Sphaira](https://github.com/ITotalJustice/sphaira/releases/) - середовище для запуску homebrew, завантаження тем та програм на свіч, файловий менеджер 
  * [Daybreak](https://github.com/Atmosphere-NX/Atmosphere/tree/0.14.1/troposphere/daybreak) - програма для безпечного оновлення версії системного програмного забезпечення консолі
  * [NXThemes Installer](https://github.com/exelix11/SwitchThemeInjector) - менеджер користувацьких тем
  * [Linkalho](https://github.com/rdmrocha/linkalho) - програма для прив'язки облікового запису
6. **Встановлені модулі**. Модулі - це додаткові компоненти, які працюють всередині Atmosphere і дозволяють робити різні круті речі, наприклад, використовувати сумісні з Xbox контролери, емуляцію amiibo, розгін і т.д. На жаль, SX OS не підтримує модулі
  * [sys-con](https://github.com/o0Zz/sys-con) - модуль, який дозволяє підключати майже будь-який геймпад до консолі через USB
  * [Mission Control](https://github.com/ndeadly/MissionControl) - модуль, який дозволяє підключати майже будь-який геймпад до консолі через bluetooth
  * [Uberhand](https://github.com/efosamark/Uberhand-Overlay) - спеціальне оверлей-меню для взаємодії з системою з підтримкою користувацьких скриптів та модулів
    - Скрипти:
      * **DBI** - зміна локалізації та оновлення програми
      * **Translate Interface** - додаткові переклади інтерфейсу на вибір
      * **Semi-stock** - завантаження в semi-stock з меню
      * **Reboot and Shutdown** - перезавантаження та вимкнення консолі з меню
    - Модулі:
      - [nx-ovlloader](https://github.com/WerWolv/nx-ovlloader//) - процес для роботи з nro через Tesla Menu
      - [ovlEdiZon.ovl](https://github.com/proferabg/EdiZon-Overlay/releases) - Модуль для використання читів
      - [ovlSysmodules.ovl](https://github.com/WerWolv/ovl-sysmodules/) - Модуль для вмикання та вимикання встановлених системних модулів (наприклад, розгону, emuuibo тощо)

## Інструкції з встановлення/оновлення kefir

### Перше встановлення або встановлення на чисту карту пам'яті

1. Скопіюйте **вміст** архіву `kefir.zip` з репозиторію в корінь карти пам'яті консолі
2. Вставте карту пам'яті в Switch
3. Запустіть консоль у прошивку, відповідно до вашого типу хаку. `payload.bin` - пейлоад, який потрібно ввести при запуску консолі через Fusée Gelée, знаходиться в архіві зі збіркою

### Оновлення kefir або перехід з іншої збірки

#### Інструкції з ручного встановлення (всі ОС)

##### Підключення карти пам'яті консолі до ПК

Якщо ви користувач MacOS, дотримуйтесь рекомендованих кроків, щоб уникнути проблем з картою пам'яті.

Якщо консоль вимкнена, вставте карту пам'яті в ПК. Якщо вона увімкнена:
1. Перезавантажте консоль через меню, яке викликається утриманням кнопки (POWER)
2. На заставці kefir натисніть кнопку зменшення гучності, щоб потрапити в hekate
3. Тепер ви можете вийняти карту пам'яті з свіча і вставити її в ПК.

> При вийманні карти пам'яті в hekate вам не доведеться повторно вводити пейлоад для входу в прошивку. Просто вставте карту в консоль і запустіть прошивку через меню **Launch**

##### Встановлення kefir (всі ОС)

1. Скопіюйте **вміст** архіву `kefir.zip` з репозиторію в корінь карти пам'яті консолі
2. Вставте карту пам'яті назад у Switch
3. У **hekate** виберіть **More configs** -> **Update Kefir**
4. Після завершення встановлення консоль завантажиться в прошивку

> Ви також можете просто вимкнути консоль, вийняти з неї карту, скопіювати kefir на неї із заміною, потім вставити карту назад у Switch і увімкнути консоль. У цьому випадку скрипт оновлення запуститься автоматично

#### Оновлення kefir безпосередньо на консолі (версія kefir 529 або вище)

1. Запустіть HBL
2. Виберіть **Kefir Updater** (потрібне підключення до Інтернету!)
3. Натисніть "**Update Kefir**", натисніть на "**Kefir [версія]**", виберіть "**Download**"
4. Дочекайтеся завершення завантаження та розпакування, потім натисніть "**Continue**". Консоль перезавантажиться в пейлоад, після чого почнеться процес встановлення kefir
5. Після завершення встановлення натисніть будь-яку кнопку, щоб завантажити консоль у прошивку

#### Чисте встановлення kefir (рекомендується при виникненні помилок)

1. Видаліть усе з карти, крім папок `Nintendo` та `emummc`, якщо вони існують
2. Встановіть kefir за допомогою зручного методу, описаного вище

#### Налагодження встановлення kefir (рекомендується, якщо чисте встановлення не допомогло)

1. Скопіюйте папки `Nintendo` та `emummc`, якщо вони існують, на ПК
2. Відформатуйте карту пам'яті в FAT32 і поверніть папки назад
3. Встановіть kefir за допомогою зручного методу

### Усунення несправностей

Якщо ви зіткнулися з помилкою [NOFAT] або будь-якою іншою проблемою з оновленням через скрипт `kefir-updater`, використовуйте встановлення kefir через `install.bat`:

1. Розпакуйте `kefir.zip` у будь-яке зручне місце **на ПК**, *крім карти пам'яті консолі*
2. **Вставте в ПК** карту пам'яті консолі
3. Запустіть `install.bat` з папки, куди ви розпакували `kefir.zip`, і вкажіть букву вашої карти пам'яті
4. Дочекайтеся завершення копіювання
5. Вставте карту в ПК і запустіть прошивку

> Якщо ви отримуєте помилку "**Is BEK missing**", вимкніть консоль і увімкніть її знову.

## Запуск Atmosphere

Якщо після входу в прошивку консоль не бачить карту і вимагає оновлення прошивки для її роботи, або просто зависає на чорному екрані після логотипу Nintendo, тоді на вашій консолі не встановлені драйвери exFAT! Відформатуйте карту пам'яті в FAT32.

У hekate за замовчуванням встановлено автозавантаження. Тобто, при запуску консолі меню hekate не буде відображатися, а одразу запуститься прошивка. Щоб перейти до меню hekate, утримуйте (VOL-) під час появи заставки.

### **Важлива інформація!**

  * Перезавантаження в hekate відбувається безпосередньо з прошивки, через звичайне меню перезавантаження. Просто утримуйте (VOL-) під час заставки kefir
  * Ви можете отримати доступ до своєї карти пам'яті, не виймаючи її з консолі, через MTP (**DBI** -> **Run MTP Responder**), або через hekate (працює не у всіх коректно, **оновити kefir через MTP неможливо**)
  * Встановлення та оновлення kefir виконуються однаково!
  * Якщо ви зіткнулися з помилкою "**Is BEK missing**", вимкніть консоль і увімкніть її знову.

## Додаткова інформація
* Для роботи з модулями ([sys-con](https://github.com/cathery/sys-con/releases/latest), [Mission Control](https://github.com/ndeadly/MissionControl) тощо) у kefir встановлено [Uberhand](https://github.com/efosamark/Uberhand-Overlay) - спеціальне оверлей-меню для взаємодії з системою. Для його активації натисніть (L) + **d-pad вниз** + (R3)
* Для переходу в semi-stock
  * **З самої прошивки**: перейдіть до Uberhand ((L) + **d-pad вниз** + (R3)), натисніть вправо > `Semi-stock`
  * **При запуску консолі**: Перейдіть до hekate і виберіть `More-configs` > `Semi-stock (blackscreen fix)`
  * Зверніть увагу, що при запуску з прошивки встановлена тема буде вимкнена, що допоможе уникнути помилок, якщо на консолі є різні версії системного програмного забезпечення та emuNAND
* Ви можете оновити kefir за допомогою утиліти **Kefir Updater**

### Розгін
* **Увімкнення**
  Для активації розгону перейдіть до Uberhand ((L) + **d-pad вниз** + (R3)), натисніть вправо > `Settings` > `Use overclock`
* **Вимкнення**
  Для вимкнення розгону перейдіть до Uberhand ((L) + **d-pad вниз** + (R3)), натисніть вправо > `Settings` > `Disable overclock`

### Режим підтримки 8ГБ пам'яті
* **Увімкнення**
  * Для увімкнення перейдіть до Uberhand ((L) + **d-pad вниз** + (R3)), натисніть вправо > `Settings` > `Enable 8GB support`
* **Вимкнення**
  * Для вимкнення переустановіть kefir за допомогою зручного методу
 
________

## Джерела Kefir перенесені сюди - [bitbucket](https://bitbucket.org/kefir-switch/kefir/src/master/), бінарні файли kefir на сторінці релізів

## Пожертвувати розробнику kefir
### Paypal
[![PayPal](https://github.com/rashevskyv/kefir/assets/18294541/5e8a41b1-a15e-4e2c-a1fc-9230379ca1fa)](https://www.paypal.com/donate/?hosted_button_id=S5BLF972J8G92)

### Банка monobank
[![mono](https://github.com/user-attachments/assets/adc1d908-c511-4e03-8d63-f0370a7752bd)](https://send.monobank.ua/jar/9PwYEXHYbs)

## Пожертвувати на підтримку України
### 🇺🇦 УКРАЇНІ ПОТРІБНА ВАША ДОПОМОГА ЗАРАЗ!
>
> Я - творець цього проекту і я українець.
>
> **На мою країну, Україну, [зараз нападає Російська Федерація](https://www.bbc.com/news/world-europe-60504334)**. Я втік з Івано-Франківська і зараз я в безпеці з моєю родиною в західній частині України. Принаймні поки що.
> Росія завдає удару по цілях по всій моїй країні балістичними ракетами.
>
> **Будь ласка, врятуйте мене і допоможіть врятувати мою країну!**
>
> Національний банк України відкрив [рахунок для збору коштів на потреби Збройних Сил України](https://bank.gov.ua/en/news/all/natsionalniy-bank-vidkriv-spetsrahunok-dlya-zboru-koshtiv-na-potrebi-armiyi):
>
> ```
> SWIFT Code NBU: NBUA UA UX
> JP MORGAN CHASE BANK, New York
> SWIFT Code: CHASUS33
> Account: 400807238
> 383 Madison Avenue, New York, NY 10179, USA
> IBAN: UA843000010000000047330992708
> ```
> 
> [Фонд "Повернись живим" (savelife.in.ua)](https://savelife.in.ua/)
> 
> ```
> BITCOIN
> bc1qkd5az2ml7dk5j5h672yhxmhmxe9tuf97j39fm6
> 
> ETHEREUM (eth, usdt, usdc)
> 0xa1b1bbB8070Df2450810b8eB2425D543cfCeF79b
> 0x93Bda139023d582C19D70F55561f232D3CA6a54c
> 
> TRC20 (tether)
> TX9aNri16bSxVYi6oMnKDj5RMKAMBXWzon
> 
> Solana (sol)
> 8icxpGYCoR8SRKqLYsSarcAjBjBPuXAuHkeJjJx5ju7a
> ```
>
> Ви також можете пожертвувати [благодійному фонду, що підтримує українську армію](https://savelife.in.ua/en/donate/).
>
> **ДЯКУЮ!**